<!DOCTYPE html>
<html>
<head>
    <title>è°ƒè¯•æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        .result { margin: 10px 0; padding: 10px; background: #f5f5f5; }
        img { max-width: 300px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>è°ƒè¯•æµ‹è¯•é¡µé¢</h1>
    
    <div class="section">
        <h2>1. æµ‹è¯•æ— å›¾ç‰‡ç”Ÿæˆ</h2>
        <button onclick="testWithoutImage()">ç”Ÿæˆæ‰‹åŠï¼ˆæ— å›¾ç‰‡ï¼‰</button>
        <div id="result1" class="result"></div>
    </div>
    
    <div class="section">
        <h2>2. æµ‹è¯•æœ‰å›¾ç‰‡ç”Ÿæˆ</h2>
        <input type="file" id="imageInput" accept="image/*" />
        <button onclick="testWithImage()">ç”Ÿæˆæ‰‹åŠï¼ˆæœ‰å›¾ç‰‡ï¼‰</button>
        <div id="result2" class="result"></div>
    </div>
    
    <div class="section">
        <h2>3. æ§åˆ¶å°æ—¥å¿—</h2>
        <div id="logs" class="result"></div>
    </div>
    
    <script>
        function log(message) {
            console.log(message);
            document.getElementById('logs').innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
        }
        
        async function testWithoutImage() {
            log('ğŸš€ å¼€å§‹æµ‹è¯•æ— å›¾ç‰‡ç”Ÿæˆ');
            
            const formData = new FormData();
            formData.append('prompt', 'beautiful anime girl');
            formData.append('service', 'grsai');
            formData.append('options', JSON.stringify({
                style: 'anime',
                pose: 'standing'
            }));
            
            try {
                const response = await fetch('/api/generate/image', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer demo-key'
                    },
                    body: formData
                });
                
                const result = await response.json();
                log('âœ… æ— å›¾ç‰‡ç”ŸæˆæˆåŠŸ: ' + result.url);
                
                document.getElementById('result1').innerHTML = `
                    <p><strong>æç¤ºè¯:</strong> ${result.prompt}</p>
                    <p><strong>æœåŠ¡:</strong> ${result.service}</p>
                    <p><strong>URL:</strong> <a href="${result.url}" target="_blank">${result.url}</a></p>
                    <img src="${result.url}" alt="ç”Ÿæˆç»“æœ" />
                `;
            } catch (error) {
                log('âŒ æ— å›¾ç‰‡ç”Ÿæˆå¤±è´¥: ' + error.message);
                document.getElementById('result1').innerHTML = '<p style="color: red;">é”™è¯¯: ' + error.message + '</p>';
            }
        }
        
        async function testWithImage() {
            const imageFile = document.getElementById('imageInput').files[0];
            if (!imageFile) {
                alert('è¯·å…ˆé€‰æ‹©å›¾ç‰‡');
                return;
            }
            
            log('ğŸš€ å¼€å§‹æµ‹è¯•æœ‰å›¾ç‰‡ç”Ÿæˆ');
            log('ğŸ“ å›¾ç‰‡æ–‡ä»¶: ' + imageFile.name + ' (' + imageFile.size + ' bytes, ' + imageFile.type + ')');
            
            const formData = new FormData();
            formData.append('prompt', 'beautiful anime girl');
            formData.append('service', 'grsai');
            formData.append('options', JSON.stringify({
                style: 'anime',
                pose: 'standing'
            }));
            formData.append('file', imageFile);
            
            try {
                const response = await fetch('/api/generate/image', {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer demo-key'
                    },
                    body: formData
                });
                
                const result = await response.json();
                log('âœ… æœ‰å›¾ç‰‡ç”ŸæˆæˆåŠŸ: ' + result.url);
                log('ğŸ“ æ–‡ä»¶å: ' + result.name + ', å¤§å°: ' + result.size + ', ç±»å‹: ' + result.type);
                
                document.getElementById('result2').innerHTML = `
                    <p><strong>æç¤ºè¯:</strong> ${result.prompt}</p>
                    <p><strong>æœåŠ¡:</strong> ${result.service}</p>
                    <p><strong>æ–‡ä»¶å:</strong> ${result.name}</p>
                    <p><strong>æ–‡ä»¶å¤§å°:</strong> ${result.size} bytes</p>
                    <p><strong>æ–‡ä»¶ç±»å‹:</strong> ${result.type}</p>
                    <p><strong>URL:</strong> <a href="${result.url}" target="_blank">${result.url}</a></p>
                    <img src="${result.url}" alt="ç”Ÿæˆç»“æœ" />
                `;
            } catch (error) {
                log('âŒ æœ‰å›¾ç‰‡ç”Ÿæˆå¤±è´¥: ' + error.message);
                document.getElementById('result2').innerHTML = '<p style="color: red;">é”™è¯¯: ' + error.message + '</p>';
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æµ‹è¯•æ— å›¾ç‰‡ç”Ÿæˆ
        window.onload = function() {
            log('ğŸ“± é¡µé¢åŠ è½½å®Œæˆ');
            testWithoutImage();
        };
    </script>
</body>
</html>


